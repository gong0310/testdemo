(function(){var e={9335:function(e,t,s){"use strict";var i=s(6369),n=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("KeepAlive",[e.$route.meta.keepAlive?t("router-view"):e._e()],1),e.$route.meta.keepAlive?e._e():t("router-view")],1)},a=[],o={name:"App",components:{},data(){return{}},mounted(){function e(){WeixinJSBridge.call("hideOptionMenu")}"undefined"==typeof WeixinJSBridge?document.addEventListener?document.addEventListener("WeixinJSBridgeReady",e,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",e),document.attachEvent("onWeixinJSBridgeReady",e)):e()},methods:{}},c=o,r=s(3736),l=(0,r.Z)(c,n,a,!1,null,null,null),u=l.exports,d=s(2631),h=function(){var e=this,t=e._self._c;return t("div",{staticClass:"login"},[t("div",{staticClass:"login-container"},[t("div",{staticClass:"login-form"},[t("p",{staticClass:"login-form-title"},[e._v("手机验证码登录")]),t("div",{staticClass:"login-form-item"},[t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.loginForm.account,expression:"loginForm.account",modifiers:{trim:!0}}],attrs:{type:"number",name:"account",placeholder:"请输入手机号"},domProps:{value:e.loginForm.account},on:{input:[function(t){t.target.composing||e.$set(e.loginForm,"account",t.target.value.trim())},function(t){return e.handleInput("account",t)}],blur:function(t){return e.$forceUpdate()}}}),t("p",{directives:[{name:"show",rawName:"v-show",value:e.loginRules.account.showIndex,expression:"loginRules.account.showIndex"}],staticClass:"login-form-item-error"},[e._v(" "+e._s(e.loginRules.account.tips[e.loginRules.account.showIndex])+" ")])]),t("div",{staticClass:"login-form-item"},[t("div",{staticClass:"login-form-code"},[t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.loginForm.code,expression:"loginForm.code",modifiers:{trim:!0}}],attrs:{type:"number",name:"code",placeholder:"请输入验证码"},domProps:{value:e.loginForm.code},on:{input:[function(t){t.target.composing||e.$set(e.loginForm,"code",t.target.value.trim())},function(t){return e.handleInput("code",t)}],blur:function(t){return e.$forceUpdate()}}}),t("button",{class:e.codeInfo.disabled?"login-form-code-disabled":"",on:{click:e.handleSendCodeValidate}},[e._v(" "+e._s(e.codeInfo.tips)+" ")])]),t("p",{directives:[{name:"show",rawName:"v-show",value:e.loginRules.code.showIndex,expression:"loginRules.code.showIndex"}],staticClass:"login-form-item-error"},[e._v(" "+e._s(e.loginRules.code.tips[e.loginRules.code.showIndex])+" ")])]),t("button",{staticClass:"login-form-submit",on:{click:e.handleLogin}},[e._v("登录")])])])])},m=[],f=(s(2801),s(3029)),g=s(5743),p=s.n(g),v=s(4161),_=s(2229),A=s.n(_),I=s(6581),w=s(6681),y=(s(7658),s(9624));const k=(e,t)=>{switch(console.log("errorHandle",e,t),e){case 401:return t||"未授权";case 403:return t||"拒绝访问";case 404:return t||"请求的资源不存在";default:return t||"接口解析错误"}};let b=!1,C=[];const E=async()=>{let e;try{e=await L()}catch(t){return void E()}X.setItem({name:y.LA,value:e.token,expires:1e3*e.token_expire_unix}),X.setItem({name:y.z6,value:e.token_refresh_unix,expires:1e3*e.token_refresh_unix})},x=v.Z.create({baseURL:{NODE_ENV:"production",BASE_URL:"./"}.VUE_APP_BASE_API,timeout:3e5,headers:{}});x.interceptors.request.use((e=>{const t=X.getItem(y.LA);return t&&(e.headers["Authorization"]=t,e.headers["Nonce-Str"]=te()),e}),(e=>Promise.reject(e))),x.interceptors.response.use((e=>{if(200===e.status&&e.data){const t=e.data;return 101!==t.code||e.config.url.includes("/kfh5/user/token/refresh")||X.getItem(y.z6)||!X.getItem(y.LA)?0!==t.code?Promise.reject({...e,code:t.code,msg:t.msg}):Promise.resolve(t.data):(console.log("无refreshToken",e.config.url),b?new Promise((t=>{C.push((s=>{e.config.headers.Authorization=s,t(x(e.config))}))})):(b=!0,(0,v.Z)({url:"/auth/refresh-token",method:"post",headers:{Authorization:X.getItem(y.LA),["Nonce-Str"]:te()}}).then((t=>{const s=t.data;return 0==s.code?(e.config.headers.Authorization=s.data.accessToken,X.setItem({name:y.LA,value:s.data.token,expires:1e3*s.data.token_expire_unix}),X.setItem({name:y.z6,value:s.data.token_refresh_unix,expires:1e3*s.data.token_refresh_unix}),C.forEach((e=>e(s.data.accessToken))),console.log("refresh response=>",C,e.config.url),C=[],x(e.config)):(console.log("刷新登录态code不为0"),E(),Promise.reject({status:y.Eh,msg:"无效请求"}))})).catch((()=>(console.log("刷新登录态异常"),E(),Promise.reject({status:y.Eh,msg:"无效请求"})))).finally((()=>{b=!1}))))}return Promise.reject({...e,msg:`错误：status：${e.status} - data：${e.data}`})}),(e=>{const{response:t}=e;if(t){const e=k(t.status,t.data.message);return console.log("结果=>","666"),Promise.reject({...t,msg:`${t.status}：${e}`})}return console.log("网络异常 请稍后重试"),Promise.reject({status:y.L_,msg:"网络异常 请稍后重试"})}));var T=x;function L(e){return T({url:"/kfh5/user/login",method:"post",data:e})}function S(e){return T({url:"/kfh5/user/profile",method:"post",data:e})}function M(e){return T({url:"/kfh5/message/session/init",method:"post",data:e})}function R(e){return T({url:"/kfh5/message/session/quit",method:"post",data:e})}function P(e){return T({url:"/kfh5/message/session/heartbeat",method:"post",data:e})}function B(e){return T({url:"/kfh5/message/send",method:"post",data:e})}function U(e){return T({url:"/kfh5/message/pull",method:"post",data:e})}function N(e){return T({url:"/kfh5/message/leave",method:"post",data:e})}function H(e){return T({url:"/kfh5/message/msqueue/query",method:"post",data:e})}function O(e){return T({url:"/kfh5/message/msqueue/hand-up",method:"post",data:e})}function Y(e){return T({url:"/kfh5/message/msqueue/evaluate",method:"post",data:e})}function D(e){return T({url:"/kfh5/message/msqueue/join",method:"post",data:e})}function Q(e){return T({url:"/kfh5/message/banner/one",method:"post",data:e})}function Z(e){return T({url:"/kfh5/message/issue/hot/list",method:"post",data:e})}function V(e){return T({url:"/kfh5/message/issue/relate/list",method:"post",data:e})}function F(e){return T({url:"/kfh5/message/order/riding/list",method:"post",data:e})}function z(e){return T({url:"/kfh5/message/filemanager/upload/apply",method:"post",data:e})}function j(e){return T({url:"/kfh5/message/filemanager/upload/success",method:"post",data:e})}const K=function(e){return/^(?:(?:\+|00)86)?1[3-9]\d{9}$/.test(e)};function q(e){const t=new w.Z;return t.setPublicKey("-----BEGIN PUBLIC KEY-----MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDE/VcJpYMrSucLPPXvjs9bnAtDnywSA3v2nuGRNlEs/PDPe1H8IKvGy8vgdIrr3Al5fKGccGdFzJznO3ieX7Omoc3qYIlZ2tbW7PQQWgFdiTaBFxUVOzct127S7mDvGpxou2OeDA2ldCVaG3z8eR2lVWSiOk2ZaGH7IXT/99etWwIDAQAB-----END PUBLIC KEY-----"),t.encrypt(e)}const G=function(e){return A()(e)},W=function(e,t){return p().unix(e).format(t||"YYYY/MM/DD HH:mm:ss")};class J{constructor(){this.name="storage"}setItem(e){let t={name:"",value:"",expires:""},s={};if(Object.assign(s,t,e),s.expires)localStorage.setItem(s.name,JSON.stringify(s));else{let e=Object.prototype.toString.call(s.value);"[object Object]"!=e&&"[object Array]"!=e||(s.value=JSON.stringify(s.value)),localStorage.setItem(s.name,s.value)}}getItem(e){let t=localStorage.getItem(e);if(!t)return!1;try{t=JSON.parse(t)}catch(s){}if(t.expires){let s=(new Date).getTime();return s>t.expires?(localStorage.removeItem(e),!1):t.value}return t}removeItem(e){localStorage.removeItem(e)}clear(){localStorage.clear()}}const X=new J;function $(e){return/^(?:(?:\+|00)86)?1\d{10}$/.test(e)}const ee=function(e){return new Promise((t=>setTimeout((()=>{t()}),e)))},te=function(){return(0,f.Z)().split("-")[0]+(new Date).getTime()+se(10)},se=function(e){const t=Math.floor((Math.random()+Math.floor(9*Math.random()+1))*Math.pow(10,e-1));return t},ie=async(e,t)=>{let s;try{s=await z(e,t)}catch(i){throw new Error(i.msg)}return s},ne=async(e,t,s)=>(0,v.Z)({url:e,data:t,method:"put",headers:s}),ae=function({session_id:e,fileData:t}){return new Promise(((s,i)=>{let n=new FileReader;n.readAsBinaryString(t),n.addEventListener("loadend",(async()=>{const a=n.result;let o=I.md.md5.create().update(a).digest(),c=window.btoa(o.data);const r={"Content-MD5":c},l=new FormData;let u,d;l.append("file",t);try{u=await ie({session_id:e,file_type:y.Ry.image,filename:t.name,md5:r["Content-MD5"],contentType:t.type,size:t.size}),u.hit||await ne(u.upload_url,t,{"Content-MD5":r["Content-MD5"],"Content-Type":t.type}),d=await oe({session_id:e,file_id:u.file_id})}catch(h){return void i({message:h.message||"上传失败，请稍后重试"})}s({file_id:u.file_id,...d})}))}))},oe=async(e,t)=>{if(!e.session_id||!e.file_id)throw new Error("参数错误");let s;try{s=await j(e,t)}catch(i){throw new Error(i.msg)}return s},ce=e=>{const t={};var s=/\?/g;if(s.test(e)){const s=e.substr(e.indexOf("?")+1),i=s.split("&");for(let e=0;e<i.length;e++){const s=i[e].split("=");t[s[0]]=s[1]}}return t},re=e=>new Blob([e],{type:e.type}),le=({blob:e,filename:t,type:s})=>new File([e],t,{type:s});var ue={name:"Login",components:{},data(){return{loginForm:{account:"",code:""},loginRules:{account:{tips:["","请输入手机号码","手机号码格式错误"],showIndex:0},code:{tips:["","请输入验证码","验证码错误"],showIndex:0}},loginLoading:!1,codeInfo:{loading:!1,tips:"获取验证码",time:6,disabled:!1}}},mounted(){},methods:{handleInput(e,t){t.target.value?"account"!=e||$(t.target.value)?this.loginRules[e].showIndex=0:this.loginRules[e].showIndex=2:this.loginRules[e].showIndex=1},async handleSendCodeValidate(){this.loginForm.account?this.loginRules.account.showIndex||this.handleSendCode():this.loginRules.account.showIndex=1},async handleSendCode(){if(this.codeInfo.disabled)return;this.codeInfo.loading=!0,this.codeInfo.tips="发送中",this.codeInfo.loading=!1,this.codeInfo.disabled=!0,this.codeInfo.tips=`${this.codeInfo.time}s`,this.codeInfo.time--;let e=setInterval((()=>{if(this.codeInfo.time<1)return this.codeInfo.disabled=!1,this.codeInfo.loading=!1,this.codeInfo.time=6,this.codeInfo.tips="重新获取",clearInterval(e),void(e=null);this.codeInfo.tips=`${this.codeInfo.time}s`,this.codeInfo.time--}),1e3)},async handleLogin(){this.loginForm.account?this.loginForm.code?this.loginRules.account.showIndex||this.loginRules.code.showIndex||(this.$loading.show(),this.$loading.hide(),console.log("请求登录成功")):this.loginRules.code.showIndex=1:this.loginRules.account.showIndex=1},async initUserInfo(){}}},de=ue,he=(0,r.Z)(de,h,m,!1,null,"6307cb86",null),me=he.exports,fe=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"home",style:e.pageLoading?" opacity: 0;pointer-events: none;":"opacity: 1;pointer-events: all;"},[e.bannerInfo.image_url?t("div",{staticClass:"banner"},[t("van-swipe",{attrs:{autoplay:3e3,"show-indicators":!1,"indicator-color":"white"}},[t("van-swipe-item",[t("img",{attrs:{src:e.bannerInfo.image_url,alt:""}})])],1)],1):e._e(),t("div",{staticClass:"chat"},[t("div",{ref:"common_chat_main",staticClass:"chat-container",on:{touchstart:e.handleTouchPage,scroll:e.handleMessageScorll}},[t("van-pull-refresh",{attrs:{"animation-duration":"0",disabled:e.chatFinished,"loosing-text":"下拉加载更多历史消息","pulling-text":"下拉加载更多历史消息"},on:{refresh:e.handleLoadHistoryList},model:{value:e.chatRefreshing,callback:function(t){e.chatRefreshing=t},expression:"chatRefreshing"}},[t("van-list",{attrs:{finished:!0,"finished-text":"",direction:"up","immediate-check":!1,offset:0},on:{load:e.onLoad},model:{value:e.chatLoading,callback:function(t){e.chatLoading=t},expression:"chatLoading"}},e._l(e.chatList,(function(s,i){return t("div",{key:i,staticClass:"chat-messages-item",attrs:{id:s.id}},[s.role==e.CHAT_ROLE_TYPE_ENUM.marginTip?t("div",{staticClass:"chat-messages-item-margin_tips"},[e._v(" "+e._s(s.content)+" ")]):e._e(),s.role==e.CHAT_ROLE_TYPE_ENUM.hotIssues?t("div",{staticClass:"chat-messages-hot_issues"},[t("div",{staticClass:"chat-messages-hot_issues-header"},[t("span",{style:`background-image: url('${e.hotIssueInfo.icon_url}');`}),t("p",[e._v("热门问题")])]),t("ul",{style:{height:e.hotIssuesHeight},attrs:{id:"hot_issues-list"}},e._l(e.hotIssueInfo.issue_list,(function(s,i){return t("li",{key:s.selfId,on:{click:function(t){return e.handleClickIssues(s)}}},[e._v(" "+e._s(i+1)+"."),t("span",[e._v(e._s(s.content))])])})),0)]):e._e(),s.role==e.CHAT_ROLE_TYPE_ENUM.roundTip?t("div",{staticClass:"chat-messages-item-roundtip"},[t("span",[e._v(e._s(s.content))])]):e._e(),s.role==e.CHAT_ROLE_TYPE_ENUM.defaultTip?t("div",{staticClass:"chat-messages-item-tips"},[e._v(" "+e._s(s.content)+" ")]):e._e(),s.role==e.CHAT_ROLE_TYPE_ENUM.switchKfBtn?t("div",{staticClass:"chat-messages-item-switch_btn"},[t("van-icon",{attrs:{name:"warning"}}),e._v(" 问题未解决，"),t("span",{on:{click:e.handleSwitchKf}},[e._v("我要转人工客服")])],1):e._e(),s.role==e.CHAT_ROLE_TYPE_ENUM.hangUpCard?t("div",{staticClass:"chat-messages-item-handup"},[t("p",{staticClass:"chat-messages-item-handup-tip"},[e._v(" - 已为您接通人工客服 - ")]),t("div",{staticClass:"chat-messages-item-handup-box"},[t("p",{staticClass:"chat-messages-item-handup-title"},[e._v(" 人工客服"+e._s(s.kfname)+" ")]),t("p",{staticClass:"chat-messages-item-handup-type"},[e._v("在线客服")]),t("p",{staticClass:"chat-messages-item-handup-btn",on:{click:function(t){return e.handleChatClose(!1,s.session_id)}}},[e._v(" 挂断聊天 ")])])]):e._e(),s.role==e.CHAT_ROLE_TYPE_ENUM.evaluate?t("div",{staticClass:"chat-messages-item-evaluate"},[t("p",{staticClass:"chat-messages-item-evaluate-title"},[e._v(" 请您对本次服务做出评价 ")]),t("div",{staticClass:"chat-messages-item-evaluate-box"},[t("span",[e._v("服务满意度")]),t("van-rate",{attrs:{size:18,color:"#FADB14","void-icon":"star","void-color":"#F5F5F5",readonly:0!==s.content},on:{change:function(t){return e.handleChangeRate(t,s)}},model:{value:s.content,callback:function(t){e.$set(s,"content",t)},expression:"item.content"}})],1)]):e._e(),s.role==e.CHAT_ROLE_TYPE_ENUM.leaveMsg?t("div",{staticClass:"chat-messages-item-leave"},[t("p",{staticClass:"chat-messages-item-leave-tip"},[e._v(" 很抱歉，暂时无法为您提供服务，请留言我们会尽快与您取得联系！ ")]),t("div",{staticClass:"chat-messages-item-leave-box"},[t("p",{staticClass:"chat-messages-item-leave-box-title"},[e._v("请留言")]),t("div",{staticClass:"chat-messages-item-leave-box-form form1"},[t("span",[e._v("联系方式")]),t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.leaveInfo.contact_info,expression:"leaveInfo.contact_info",modifiers:{trim:!0}}],attrs:{type:"number",placeholder:"请预留您的联系方式"},domProps:{value:e.leaveInfo.contact_info},on:{input:function(t){t.target.composing||e.$set(e.leaveInfo,"contact_info",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})]),t("div",{staticClass:"chat-messages-item-leave-box-form form2"},[t("span",[e._v("问题描述")]),t("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:e.leaveInfo.issue_desc,expression:"leaveInfo.issue_desc",modifiers:{trim:!0}}],attrs:{placeholder:"请描述您的问题",maxlength:"200"},domProps:{value:e.leaveInfo.issue_desc},on:{input:function(t){t.target.composing||e.$set(e.leaveInfo,"issue_desc",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})]),t("button",{staticClass:"chat-messages-item-leave-box-btn",on:{click:e.handldeSubmitLeave}},[e._v(" 提交 ")])])]):e._e(),s.role==e.CHAT_ROLE_TYPE_ENUM.leaveMsgBtn?t("div",{staticClass:"chat-messages-item-leavebtn"},[t("p",{staticClass:"chat-messages-item-leavebtn-tip"},[e._v(" "+e._s(s.content)+" ")]),t("p",{staticClass:"chat-messages-item-leavebtn-btn",on:{click:e.handleLeaveMessageShow}},[e._v(" 【我要留言】 ")])]):e._e(),s.role==e.CHAT_ROLE_TYPE_ENUM.relatedIssues?t("div",{staticClass:"chat-messages-item-related_issues"},[t("p",{staticClass:"chat-messages-item-related_issues-title"},[e._v(" 以下问题是你关心的吗？ ")]),t("ul",{staticClass:"chat-messages-item-related_issues-list"},e._l(s.content,(function(s,i){return t("li",{key:i,on:{click:function(t){return e.handleClickIssues(s)}}},[e._v(" "+e._s(s.content)+" ")])})),0)]):s.role==e.CHAT_ROLE_TYPE_ENUM.user?t("div",{staticClass:"chat-messages-item-me"},[t("div",{staticClass:"chat-messages-item-me-user"},[s.contentType==e.CHAT_CONTENT_TYPE_ENUM.text?t("div",{staticClass:"chat-messages-item-me-user-content"},[t("div",{staticClass:"chat-messages-item-me-user-content-box"},[s.sendLoading?t("van-icon",{staticClass:"resend-btn loading-btn",attrs:{name:"replay"}}):s.sendSuss?e._e():t("van-icon",{staticClass:"resend-btn",attrs:{name:"warning"},on:{click:function(t){return e.handleReSendMeaasge(s)}}}),t("p",{staticClass:"chat-messages-item-me-user-content-text",domProps:{innerHTML:e._s(s.content.text)}})],1)]):s.contentType==e.CHAT_CONTENT_TYPE_ENUM.image?t("div",{staticClass:"chat-messages-item-me-user-content"},[t("div",{staticClass:"chat-messages-item-me-user-content-box"},[s.sendLoading?t("van-icon",{staticClass:"resend-btn loading-btn",attrs:{name:"replay"}}):s.sendSuss?e._e():t("van-icon",{staticClass:"resend-btn",attrs:{name:"warning"},on:{click:function(t){return e.handleReSendMeaasge(s)}}}),t("img",{staticClass:"img",attrs:{src:s.content.image},on:{click:function(t){return e.handlePicShow(s.content.image)}}})],1)]):s.contentType==e.CHAT_CONTENT_TYPE_ENUM.ride?t("div",{staticClass:"chat-messages-item-me-user-content ride"},[t("div",{staticClass:"chat-messages-item-me-user-content-box"},[s.sendLoading?t("van-icon",{staticClass:"resend-btn loading-btn",attrs:{name:"replay"}}):s.sendSuss?e._e():t("van-icon",{staticClass:"resend-btn",attrs:{name:"warning"},on:{click:function(t){return e.handleReSendMeaasge(s)}}}),t("div",{staticClass:"chat-messages-item-me-user-ride"},[t("p",{staticClass:"chat-messages-item-me-user-ride-title"},[e._v(" 乘车时间"),t("span",{staticStyle:{"margin-left":"5px"}},[e._v(e._s(e.timestamp2String(s.content.ride_record.pay_unix)))])]),t("div",{staticClass:"chat-messages-item-me-user-ride-info"},[t("p",{staticClass:"chat-messages-item-me-user-ride-info-title"},[e._v(" "+e._s(s.content.ride_record.start_station)+" — "+e._s(s.content.ride_record.terminal)+" ")]),t("p",{staticClass:"chat-messages-item-me-user-ride-info-count"},[e._v(" -¥"+e._s(s.content.ride_record.amount)+" ")])])])],1)]):e._e(),t("div",{staticClass:"chat-messages-item-me-user-avatar"},[t("img",{attrs:{src:e.userProfile.avatar_url,alt:""}})])])]):s.role==e.CHAT_ROLE_TYPE_ENUM.staff||s.role==e.CHAT_ROLE_TYPE_ENUM.robot?t("div",{staticClass:"chat-messages-item-you"},[t("div",{staticClass:"chat-messages-item-you-user"},[t("div",{staticClass:"chat-messages-item-you-user-avatar"},[t("img",{attrs:{src:s.kfAvatar,alt:""}})]),t("div",{staticClass:"chat-messages-item-you-user-info"},[t("p",{staticClass:"chat-messages-item-you-user-info-name"},[e._v(" "+e._s(s.kfname)+" ")]),s.contentType==e.CHAT_CONTENT_TYPE_ENUM.text?t("div",{staticClass:"chat-messages-item-you-user-content"},[t("p",{staticClass:"chat-messages-item-you-user-content-text",domProps:{innerHTML:e._s(s.content.text)}})]):s.contentType==e.CHAT_CONTENT_TYPE_ENUM.image?t("div",{staticClass:"chat-messages-item-you-user-content"},[t("img",{staticClass:"img",attrs:{src:s.content.image},on:{click:function(t){return e.handlePicShow(s.content.image)}}})]):s.contentType==e.CHAT_CONTENT_TYPE_ENUM.auto?t("div",{staticClass:"chat-messages-item-you-user-content"},[t("div",{staticClass:"chat-messages-item-you-user-content-auto"},[t("input",{staticStyle:{display:"none"},attrs:{type:"checkbox",id:"exp"}}),t("div",{staticClass:"chat-messages-item-you-user-content-auto-txt",attrs:{id:s.moreId}},[e._v(" "+e._s(s.content.text)+" ")]),s.showMoreBtn?t("label",{staticClass:"chat-messages-item-you-user-content-auto-btn",attrs:{for:"exp"},on:{click:function(t){return e.handleIssuesMoreShow(s)}}},[e._v(" 查看更多 ")]):e._e()])]):e._e()])])]):e._e()])})),0)],1)],1)]),t("div",{staticClass:"chat-footer"},[t("div",{staticClass:"chat-footer-tags"},[e.waitInfo.state==e.WAIT_STATUS_ENUM.success?t("div",{on:{click:function(t){return e.handleChatClose(!1,e.waitInfo.session_id)}}},[t("span"),e._v(" 挂断聊天 ")]):e._e(),t("div",{on:{click:e.handleRideRecordShow}},[e._v("乘车记录")]),t("div",{on:{click:e.handleRouterToLeaveMsg}},[e._v("留言列表")])]),t("div",{staticClass:"chat-footer-wrapper"},[t("div",{staticClass:"chat-footer-wrapper-box"},[t("div",{staticClass:"chat-footer-input",attrs:{maxlength:"500",contenteditable:"true"},on:{blur:e.handleInputBlur,focus:e.handleInputFocus,input:e.handleInput}}),e.chatInputFocus||e.chatInputContent?e._e():t("p",[e._v(" "+e._s(e.chatInfo.chat_window.prompt)+" ")])]),t("div",{staticClass:"chat-footer-send"},[t("div",{staticClass:"chat-footer-send-pic"},[t("input",{attrs:{type:"file",accept:"image/png, image/jpeg, image/gif, image/jpg",multiple:""},on:{change:e.handleChangeFile}}),t("img",{attrs:{src:s(7945),alt:""}})]),t("span",{staticClass:"chat-footer-send-txt",on:{click:function(t){return t.preventDefault(),e.handleSendText(t,null)}}})])])]),t("van-overlay",{attrs:{show:e.picVisible},on:{click:e.handlePicHide}},[e.picVisible?t("div",{staticClass:"view-pic",on:{click:e.handlePicHide}},[t("img",{attrs:{src:e.picSrc,alt:""}})]):e._e()]),t("van-overlay",{attrs:{show:e.leaveMessageVisible},on:{click:e.handleLeaveMessageHide}},[t("div",{staticClass:"leave",on:{click:function(e){e.stopPropagation()}}},[t("div",{staticClass:"leave-box"},[t("p",{staticClass:"leave-box-title"},[e._v("请留言")]),t("div",{staticClass:"leave-box-form form1"},[t("span",[e._v("联系方式")]),t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.leaveInfo.contact_info,expression:"leaveInfo.contact_info",modifiers:{trim:!0}}],attrs:{type:"number",placeholder:"请预留您的联系方式"},domProps:{value:e.leaveInfo.contact_info},on:{input:function(t){t.target.composing||e.$set(e.leaveInfo,"contact_info",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})]),t("div",{staticClass:"leave-box-form form2"},[t("span",[e._v("问题描述")]),t("textarea",{directives:[{name:"model",rawName:"v-model.trim",value:e.leaveInfo.issue_desc,expression:"leaveInfo.issue_desc",modifiers:{trim:!0}}],attrs:{placeholder:"请描述您的问题",maxlength:"200"},domProps:{value:e.leaveInfo.issue_desc},on:{input:function(t){t.target.composing||e.$set(e.leaveInfo,"issue_desc",t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}})]),t("button",{staticClass:"leave-box-btn",on:{click:function(t){return t.stopPropagation(),e.handldeSubmitLeave.apply(null,arguments)}}},[e._v(" 提交 ")])])])]),t("van-overlay",{attrs:{show:e.leaveMessageSuccVisible},on:{click:e.handleLeaveMessageSuccHide}},[t("div",{staticClass:"leave-succ"},[t("div",{staticClass:"leave-succ-box"},[t("img",{attrs:{src:s(7726),alt:""}}),t("p",{staticClass:"leave-succ-box-title"},[e._v("提交留言成功")]),t("p",{staticClass:"leave-succ-box-tip"},[e._v(" 我们会尽快与您取得联系，请耐心等候！ ")])])])]),t("van-popup",{attrs:{closeable:"",position:"bottom"},model:{value:e.rideRecordVisible,callback:function(t){e.rideRecordVisible=t},expression:"rideRecordVisible"}},[t("div",{staticClass:"ride-record"},[t("p",{staticClass:"ride-record-title"},[e._v("乘车记录")]),t("van-tabs",{attrs:{swipeable:"",animated:"","swipe-threshold":"3"},on:{change:e.handleRideSlideChange},model:{value:e.rideTabList.tabIndex,callback:function(t){e.$set(e.rideTabList,"tabIndex",t)},expression:"rideTabList.tabIndex"}},e._l(e.rideTabList.tabList,(function(i,n){return t("van-tab",{key:n,staticClass:"ride-record-box",attrs:{title:i.label}},[t("van-pull-refresh",{on:{refresh:function(t){return e.rideOnRefresh(i)}},model:{value:i.refreshing,callback:function(t){e.$set(i,"refreshing",t)},expression:"tabItem.refreshing"}},[i.list.length?t("van-list",{staticClass:"ride-record-list",attrs:{finished:i.finished,"finished-text":"没有更多了~","immediate-check":!1,offset:50},on:{load:function(t){return e.initRideList({page:i.page,size:i.size,pay_method:i.value})}},model:{value:i.loading,callback:function(t){e.$set(i,"loading",t)},expression:"tabItem.loading"}},e._l(i.list,(function(s,i){return t("div",{key:i,staticClass:"ride-record-item"},[t("div",{staticClass:"ride-record-info"},[t("p",{staticClass:"ride-record-info-title"},[e._v(" "+e._s(s.start_station)+" — "+e._s(s.terminal)+" ")]),t("p",{staticClass:"ride-record-info-date"},[e._v(" "+e._s(e.timestamp2String(s.pay_unix))+" ")])]),t("div",{staticClass:"ride-record-opt"},[t("p",{staticClass:"ride-record-opt-count"},[e._v(" -¥"+e._s(s.amount)+" ")]),t("button",{staticClass:"ride-record-opt-send",on:{click:function(t){return e.handleSendRide(s)}}},[e._v(" 发送 ")])])])})),0):t("div",{staticClass:"ride-record-empty"},[t("img",{attrs:{src:s(8773),alt:""}}),t("p",[e._v("暂无乘车记录")])])],1)],1)})),1)],1)])],1)])},ge=[],pe=(s(541),s(6229),s(7330),s(2062),s(5940)),ve=s.n(pe),_e={name:"HomeChat",data(){return{CHAT_ROLE_TYPE_ENUM:y.Sc,RIDE_PAY_TYPE_LIST:y.JK,CHAT_CONTENT_TYPE_ENUM:y.vx,WAIT_STATUS_ENUM:y.yP,timestamp2String:W,pageLoading:!0,chatInputContent:"",chatInputFocus:!1,firstMsgId:"",chatList:[],channelId:"",chatLoading:!1,chatFinished:!1,chatRefreshing:!1,picVisible:!1,picSrc:"",leaveMessageVisible:!1,leaveMessageSuccVisible:!1,leaveInfo:{contact_info:"",issue_desc:""},rideRecordVisible:!1,rideTabList:{tabIndex:0,tabList:[{loading:!1,finished:!1,refreshing:!1,label:y.gj[y.eC.zfb].label,value:y.eC.zfb,list:[],page:1,size:y.NR},{loading:!1,finished:!1,refreshing:!1,label:y.gj[y.eC.wx].label,value:y.eC.wx,list:[],page:1,size:y.NR},{loading:!1,finished:!1,refreshing:!1,label:y.gj[y.eC.union].label,value:y.eC.union,list:[],page:1,size:y.NR},{loading:!1,finished:!1,refreshing:!1,label:y.gj[y.eC.digital].label,value:y.eC.digital,list:[],page:1,size:y.NR},{loading:!1,finished:!1,refreshing:!1,label:y.gj[y.eC.wxQrocode].label,value:y.eC.wxQrocode,list:[],page:1,size:y.NR}]},userProfile:{user_id:"",nickname:"",avatar_url:""},chatInfo:{session_id:"",chat_window:{name:y.i2,notes:"",welcome_message:"",prompt:y.iu,robot:{nickname:"",avatar_url:""}}},bannerInfo:{image_url:""},hotIssueInfo:{icon_url:"",issue_list:[]},hotIssuesHeight:"",relateIssueLoading:!1,waitInfo:{},waitList:[],kfReply:{timer:null,time:480},messageQuitTimer:null,messageQuitTime:0,messageQuitTipEnd:!1}},created(){{let e=navigator.userAgent;e.indexOf("iPhone")>-1&&ve().enable()}},watch:{$route(e){console.log("=======",e.path),"/leavemsg-list"==e.path&&(this.pageLoading=!0),"/"==e.path&&(document.title=this.chatInfo.chat_window.name,this.$nextTick((()=>{this.goEnd((()=>{this.pageLoading=!1}))})))}},computed:{disabledLeaveSubmit(){return!K(this.leaveInfo.contact_info)||!this.leaveInfo.issue_desc}},beforeDestroy(){ve().disable()},async mounted(){let e;if(console.log("==================mounted page init=================="),/metro/i.test(navigator.userAgent)||/metro mPaaSClient/i.test(navigator.userAgent))console.log("ios",/metro/i.test(navigator.userAgent)),console.log("安卓",/metro mPaaSClient/i.test(navigator.userAgent)),console.log("大都会MetroApp"),window.AlipayJSBridge&&window.AlipayJSBridge.call("getUserId",(function(t){console.log("大都会APP UID",t),e=t.uid}));else{const t=ce("https://www.baidu.com/?uid=admin&fid=2&channel=小明");if(console.log("小程序 url参数",t),!t.uid)return console.error("未解析出uid"),void this.$router.replace("/error");e=t.uid}if(!X.getItem(y.LA)){let t={auth_code:window.btoa(encodeURIComponent(q(e)))};try{await this.initLogin(t)}catch(n){return console.error("mounted initLogin",n),void this.$router.replace("/error")}}try{await this.init()}catch(n){return console.error("mounted init",n),void(n.message==y.L_?this.$toast({message:"网络异常 请稍后重试"}):n.message!=y.Eh&&this.$toast({message:n.message}))}this.sessionHeartbeat(),setInterval((()=>{this.sessionHeartbeat()}),3e4),window.addEventListener("onbeforeunload",(()=>{this.messageQuit()})),this.goEnd((()=>{this.pageLoading=!1,console.log("==================mounted page loaded==================")})),this.setFirstMsgId(),this.initMoreBtn();const t=s(6084),i=t();i.listenTo(document.getElementsByClassName("chat-footer"),(function(e){var t=e.offsetHeight;document.getElementsByClassName("home")[0].style["padding-bottom"]=t+0+"px"}))},methods:{handleRouterToLeaveMsg(){this.$router.push({path:"/leavemsg-list"})},async init(){console.log("init invoke");const e=ce("https://www.baidu.com/?uid=admin&uid=1&fid=2&channel=小明");if(!e.channel)throw new Error("参数错误");this.channelId=e.channel;try{await this.initChatInfo(),await this.initUserProfile(),await this.initBanner();for(const t of this.rideTabList.tabList)this.initRideList({page:t.page,size:t.size,pay_method:t.value});if([y.yP.fail].includes(this.chatInfo.state))return void console.warn("init fail",this.chatInfo.state);let e=await this.getMessage({mode:y.XI.prev,start_message_id:"",size:300});e=this.filterMessage(e),console.log("init 历史记录",e),e.length||(this.chatFinished=!0),this.chatList.unshift(...e),this.addChatTime(this.chatList),await this.initHotIssueList(),this.goEnd()}catch(t){throw new Error(t.message)}},async initLogin(){let e;console.log("initLogin invoke");try{e=await L()}catch(t){throw t.status!=y.Eh&&t.status!=y.L_?new Error(t.msg):new Error(t.status)}console.log("initLogin success resp=",e),X.setItem({name:y.LA,value:e.token,expires:1e3*e.token_expire_unix}),X.setItem({name:y.z6,value:e.token_refresh_unix,expires:1e3*e.token_refresh_unix})},async initUserProfile(){let e;console.log("initUserProfile invoke");try{e=await S()}catch(t){throw t.status!=y.Eh&&t.status!=y.L_?new Error(t.msg):new Error(t.status)}console.log("initUserProfile success resp=",e),this.userProfile=e},async initChatInfo(){let e;console.log("initChatInfo invoke",this.chatInfo.state);try{e=await this.initMessageInfo()}catch(t){if(t.message!=y.Eh)throw new Error(t.message);return}switch(this.chatInfo.state){case y.yP.init:this.chatList.push({id:te(),createUnix:parseInt((new Date).getTime()/1e3),sendSuss:!0,sendLoading:!1,showMoreBtn:!1,moreId:te(),customId:te(),role:y.Sc.robot,contentType:y.vx.auto,kfname:this.chatInfo.chat_window.robot.nickname,kfAvatar:this.chatInfo.chat_window.robot.avatar_url,content:{text:this.chatInfo.chat_window.welcome_message}});break;case y.yP.inqueue:let s=!1;try{const e=await this.getQueueStatus();if(console.log("initChatInfo getQueueStatus resp=",e),e.state==y.yP.success||0==e.in_queue_count)this.chatList.push({role:y.Sc.hangUpCard,content:"",customId:te(),kfId:e.staff_info.user_id,kfname:e.staff_info.nickname,session_id:e.session_id}),this.chatList.push({role:y.Sc.staff,contentType:y.vx.text,content:{text:`您好，客服${e.staff_info.nickname}为您服务，请问您有什么需要咨询的问题吗？`},customId:te(),sendSuss:!0,sendLoading:!1,showMoreBtn:!1,moreId:te(),kfId:e.staff_info.user_id,kfname:e.staff_info.nickname,kfAvatar:e.staff_info.avatar_url}),this.chatInfo.session_id=e.session_id,s=!0,this.watchChatActive();else if(e.state==y.yP.inqueue){if(this.waitInfo.in_queue_count===e.in_queue_count)return;this.chatList.push({role:y.Sc.roundTip,customId:te(),content:`在当前排队${e.in_queue_count}人，请稍后…`})}else e.state==y.yP.fail&&(this.chatList.push({role:y.Sc.leaveMsgBtn,customId:te(),content:"很抱歉，暂时无法为您提供服务，请留言我们会尽快与您取得联系！"}),s=!0);this.goEnd(null,100),this.waitInfo=e}catch(t){return void(t.message==y.L_?(this.chatList.push({role:y.Sc.defaultTip,customId:te(),content:"- 网络异常 请稍后重试 -"}),this.goEnd(null,100)):t.message!=y.Eh&&this.$toast({message:t.message}))}if(s)return;this.waitSwtichStaff(!0);break;case y.yP.success:this.chatList.push({role:y.Sc.hangUpCard,content:"",customId:te(),kfId:this.chatInfo.staff_info.user_id,kfname:this.chatInfo.staff_info.nickname,session_id:e.session_id}),this.chatList.push({role:y.Sc.staff,contentType:y.vx.text,content:{text:`您好，客服${this.chatInfo.staff_info.nickname}为您服务，请问您有什么需要咨询的问题吗？`},customId:te(),sendSuss:!0,sendLoading:!1,showMoreBtn:!1,moreId:te(),kfId:this.chatInfo.staff_info.user_id,kfname:this.chatInfo.staff_info.nickname,kfAvatar:this.chatInfo.staff_info.avatar_url}),this.waitInfo.state=y.yP.success,this.waitInfo.session_id=e.session_id,this.chatInfo.session_id=e.session_id,this.watchChatActive();break;case y.yP.transfer:this.chatList.push({role:y.Sc.roundTip,customId:te(),content:"客服转接中，请稍后…"}),this.goEnd(null,100),this.switchStaff();break;case y.yP.fail:this.chatList.push({sendSuss:!0,sendLoading:!1,customId:te(),role:y.Sc.leaveMsg}),this.chatFinished=!0;break;case y.yP.evaluate:this.chatList.push({role:y.Sc.defaultTip,customId:te(),content:"- 本次服务已完成，请为本次服务做出评价! -"}),this.chatList.push({role:y.Sc.evaluate,customId:te(),content:0,session_id:this.chatInfo.session_id});break;default:break}},async initMessageInfo(){console.log("initMessageInfo invoke");const e={channel:this.channelId};let t;try{t=await M(e)}catch(s){throw s.status!=y.Eh&&s.status!=y.L_?new Error(s.msg):new Error(s.status)}return console.log("initMessageInfo success resp=",t),t.chat_window.name=t.chat_window.name||y.i2,t.chat_window.prompt=t.chat_window.prompt||y.iu,this.chatInfo=t,document.title=this.chatInfo.chat_window.name,t},async initBanner(){console.log("initBanner invoke");const e={session_id:this.chatInfo.session_id};let t;try{t=await Q(e)}catch(s){throw s.status!=y.Eh&&s.status!=y.L_?new Error(s.msg):new Error(s.status)}console.log("initBanner success resp=",t),this.bannerInfo=t,this.bannerInfo.image_url||(document.getElementsByClassName("home")[0].style["padding-top"]=0)},async initHotIssueList(){let e;console.log("initHotIssueList invoke");try{e=await Z()}catch(t){throw t.status!=y.Eh&&t.status!=y.L_?new Error(t.msg):new Error(t.status)}e.issue_list=e.issue_list.map((e=>({...e,selfId:e.id}))),console.log("initHotIssueList success resp=",e),console.log("-------------------",e.issue_list.slice(0,10)),this.chatList.unshift({role:y.Sc.hotIssues,content:e}),e.issue_list.length>10?(this.hotIssueInfo={icon_url:e.icon_url,issue_list:e.issue_list.slice(0,10)},await this.$nextTick(),this.hotIssuesHeight=document.querySelector("#hot_issues-list").getBoundingClientRect().height+"px",this.hotIssueInfo.issue_list=e.issue_list):this.hotIssueInfo=e},async initRideList(e){console.log("initRideList invoke",e);const t={session_id:this.chatInfo.session_id,page:e.page,size:e.size,pay_method:e.pay_method};let s;console.log("initRideList req=",t);try{s=await F(t)}catch(n){throw n.status!=y.Eh&&n.status!=y.L_?new Error(n.msg):new Error(n.status)}console.log("initRideList success resp=",s),s.riding_list=s.riding_list.map((e=>({...e,selfId:e.id})));const i=this.rideTabList.tabList.find((t=>t.value==e.pay_method));if(!s.riding_list.length)return i.finished=!0,void(i.loading=!1);e.refresh?i.list=s.riding_list||[]:i.list.push(...s.riding_list||[]),i.loading=!1,i.page++},initMoreBtn(){console.log("initMoreBtn invoke"),this.$nextTick((()=>{this.chatList=this.chatList.map((e=>{if(e.contentType==y.vx.auto){const t=document.getElementById(e.moreId);t.scrollHeight>t.clientHeight+10?(console.log("initMoreBtn show",e),e.showMoreBtn=!0):e.showMoreBtn=!1}return e}))}))},watchChatActive(){console.log("watchChatActive invoke"),clearInterval(this.messageQuitTimer),this.messageQuitTimer=null,this.messageQuitTime=0,this.messageQuitTipEnd=!1,this.messageQuitTimer=setInterval((()=>{this.messageQuitTime+=1,!this.messageQuitTipEnd&&this.messageQuitTime>=18&&(console.log("180秒不发消息，超时提醒"),this.chatList.push({role:y.Sc.defaultTip,customId:te(),content:"会话回复已超时，请及时回复哦，我们将全力协助您解决"}),this.goEnd(null,100),this.messageQuitTipEnd=!0),this.messageQuitTime>=22&&(console.log("220秒不发消息，退出会话"),clearInterval(this.messageQuitTimer),this.messageQuitTimer=null,this.chatList.push({role:y.Sc.defaultTip,customId:te(),content:"会话回复超时，会话挂断，本次服务已完成，请为本次服务做出评价！"}),this.goEnd(null,100),this.handleChatClose(!0,this.waitInfo.session_id))}),1e3)},async waitSwtichStaff(e=!1){console.log("waitSwtichStaff invoke",e);let t=setInterval((async()=>{try{const s=await this.getQueueStatus();if(console.log("waitSwtichStaff getQueueStatus resp=",s),s.state==y.yP.success||0==s.in_queue_count)clearInterval(t),t=null,!0===e?this.chatList.push({role:y.Sc.defaultTip,customId:te(),content:"- 客服接入成功，很高兴为您服务！-"}):this.chatList.push({role:y.Sc.hangUpCard,content:"",customId:te(),kfId:s.staff_info.user_id,kfname:s.staff_info.nickname,session_id:s.session_id}),this.chatList.push({role:y.Sc.staff,contentType:y.vx.text,content:{text:`您好，客服${s.staff_info.nickname}为您服务，请问您有什么需要咨询的问题吗？`},customId:te(),sendSuss:!0,sendLoading:!1,showMoreBtn:!1,moreId:te(),kfId:s.staff_info.user_id,kfname:s.staff_info.nickname,kfAvatar:s.staff_info.avatar_url}),this.watchChatActive(),this.chatInfo.session_id=s.session_id;else if(s.state==y.yP.inqueue){if(this.waitInfo.in_queue_count===s.in_queue_count)return;this.chatList.push({role:y.Sc.roundTip,customId:te(),content:`在当前排队${s.in_queue_count}人，请稍后…`})}else s.state==y.yP.fail&&(clearInterval(t),t=null,this.chatList.push({role:y.Sc.leaveMsgBtn,customId:te(),content:"很抱歉，暂时无法为您提供服务，请留言我们会尽快与您取得联系！"}));this.goEnd(null,100),this.waitInfo=s}catch(s){return s.message==y.L_?(this.chatList.push({role:y.Sc.defaultTip,customId:te(),content:"- 网络异常 请稍后重试 -"}),this.goEnd(null,100)):s.message!=y.Eh&&this.$toast({message:s.message}),clearInterval(t),void(t=null)}}),1e3)},filterMessage(e){return e.map((e=>{const t={selfId:e.selfId,client_message_id:e.client_message_id,message_id:e.message_id,role:"",contentType:e.message_type,content:e.content,createUnix:e.create_unix,sendSuss:!0,sendLoading:!1,showMoreBtn:!1,id:te(),moreId:te(),customId:te()};return e.belong_to==y.bj.user?t.role=y.Sc.user:e.belong_to==y.bj.staff&&e.staff_info.user_id?(t.role=y.Sc.staff,t.kfId=e.staff_info.user_id,t.kfname=e.staff_info.nickname,t.kfAvatar=e.staff_info.avatar_url):(t.role=y.Sc.robot,t.contentType=y.vx.auto,t.kfname=this.chatInfo.chat_window.robot.nickname,t.kfAvatar=this.chatInfo.chat_window.robot.avatar_url),t}))},async getRelateIssueList(e){const t={session_id:this.chatInfo.session_id,message:e};let s;try{s=await V(t)}catch(i){return this.$toast({message:i.msg}),[]}finally{this.relateIssueLoading=!1}s.issue_list=s.issue_list||[],s.issue_list=s.issue_list.map((e=>({...e,selfId:e.id}))),console.log("==========getRelateIssueList",s),s.issue_list.length&&(this.chatList.push({customId:te(),role:y.Sc.relatedIssues,content:s.issue_list}),this.goEnd())},async getMessageRegularTime(){if(clearInterval(this.kfReply.timer),this.kfReply.timer=null,this.kfReply.time=480,this.kfReply.timer=setInterval((async()=>{if(this.kfReply.time--,this.kfReply.time<=0)return console.log("======：客服回复超出时长超时，转接其他客服---\x3e留言大弹窗"),this.chatList.push({role:y.Sc.defaultTip,customId:te(),content:"很抱歉，目前无法准确定位您的问题，我们正在为您转接其他客服"}),this.chatList.push({role:y.Sc.roundTip,customId:te(),content:"客服转接中，我们正在为您转接其他客服，请稍后…"}),this.goEnd(null,100),clearInterval(this.kfReply.timer),this.kfReply.timer=null,void this.switchStaff()}),1e3),this.kfReply.time<=0)return;const e=G(this.chatList).reverse().find((e=>e.selfId));let t=await this.getMessage({mode:y.XI.next,start_message_id:e?e.message_id:""});if(t=this.filterMessage(t),this.kfReply.time<=0)return;console.log("=======getMessageRegularTime",t);const s=[];t.forEach((e=>{let t=this.chatList.find((t=>t.client_message_id==e.client_message_id));t?t=Object.assign(t,e):s.push(e)})),this.chatList.push(...s),this.addChatTime(this.chatList),this.initMoreBtn(),this.goEnd(),this.getMessageRegularTime()},async handleReSendMeaasge(e){console.log("=======handleReSendMeaasge",e);const t=this.chatList.findIndex((t=>t.client_message_id===e.client_message_id)),s=this.chatList.splice(t,1);if(this.chatList.push(...s),e.sendLoading=!0,e.contentType==y.vx.text){const t={message:e.content,type:y.vx.text,client_message_id:e.client_message_id};try{await this.createMessage(t)}catch(i){return void(e.sendSuss=!1)}finally{e.sendLoading=!1}if(e.sendSuss=!0,this.relateIssueLoading)return;this.relateIssueLoading=!0,await ee(1e3),this.getRelateIssueList(e.content)}if(e.contentType==y.vx.image){let t,s=le({blob:e.file.blob,filename:e.file.filename,type:e.file.type});console.log("==========",e.file,s);try{t=await ae({session_id:this.chatInfo.session_id,fileData:s})}catch(i){return e.sendSuss=!1,void(e.sendLoading=!1)}const n={message:t.download_url,type:y.vx.image,client_message_id:e.client_message_id};try{await this.createMessage(n)}catch(i){return void(e.sendSuss=!1)}finally{e.sendLoading=!1}e.sendSuss=!0}if(e.contentType==y.vx.ride){const t={message:e.selfId,type:y.vx.ride,client_message_id:e.client_message_id};try{await this.createMessage(t)}catch(i){return void(e.sendSuss=!1)}finally{e.sendLoading=!1}e.sendSuss=!0}},async switchStaff(){console.log("switchStaff invoke");let e=!1;try{const t=await this.msqueueJoin();if(console.log("switchStaff msqueueJoin resp=",t),t.state==y.yP.success)this.chatList.push({role:y.Sc.defaultTip,customId:te(),content:"- 客服接入成功，很高兴为您服务！-"}),this.chatList.push({role:y.Sc.staff,contentType:y.vx.text,content:{text:`您好，客服${t.staff_info.nickname}为您服务，请问您有什么需要咨询的问题吗？`},customId:te(),sendSuss:!0,sendLoading:!1,showMoreBtn:!1,moreId:te(),kfId:t.staff_info.user_id,kfname:t.staff_info.nickname,kfAvatar:t.staff_info.avatar_url}),e=!0,this.chatInfo.session_id=t.session_id,this.watchChatActive();else if(t.state==y.yP.inqueue){if(this.waitInfo.in_queue_count===t.in_queue_count)return;this.chatList.push({role:y.Sc.defaultTip,customId:te(),content:"转接客服失败，当前无空闲人员接待，已为您进入排队队列"}),this.chatList.push({role:y.Sc.roundTip,customId:te(),content:`在当前排队${t.in_queue_count}人，请稍后…`})}else t.state==y.yP.fail&&(this.chatList.push({role:y.Sc.leaveMsgBtn,customId:te(),content:"转接客服失败，暂时无法为您提供服务，请留言我们会尽快与您取得联系！"}),e=!0);if(this.goEnd(null,100),this.waitInfo=t,e)return;this.waitSwtichStaff(!0)}catch(t){return void(t.message==y.L_?(this.chatList.push({role:y.Sc.defaultTip,customId:te(),content:"- 网络异常 请稍后重试 -"}),this.goEnd(null,100)):t.message!=y.Eh&&this.$toast({message:t.message}))}},async getQueueStatus(){const e={session_id:this.chatInfo.session_id};let t;try{t=await H(e)}catch(s){throw s.status!=y.Eh&&s.status!=y.L_?new Error(s.msg):new Error(s.status)}return t},handleClickIssues(e){this.handleSendText(null,e.content)},async handleChangeFile(e){console.log("选择图片=>",e,e.target.files);const t=e.target.files;if(!t.length)return;if(t.length>9)return void this.$toast("最多可选择9张");let s=!0;for(let n=0;n<t.length;n++){const e=t[n];if(!/\/(jpg|jpeg|png|gif)$/.test(e.type)){this.$toast("请上传图片格式"),s=!1;break}}if(s)for(let n=0;n<t.length;n++){const e=t[n];let s=URL.createObjectURL(e);const a={role:y.Sc.user,contentType:y.vx.image,content:{image:s},sendLoading:!0,sendSuss:!0,customId:te(),client_message_id:te(),file:{blob:re(e),url:s,filename:e.name,type:e.type}};let o;this.chatList.push(a),this.goEnd();try{o=await ae({session_id:this.chatInfo.session_id,fileData:e})}catch(i){return a.sendSuss=!1,void(a.sendLoading=!1)}const c={message:o.download_url,type:y.vx.image,client_message_id:a.client_message_id};try{await this.createMessage(c)}catch(i){return void(a.sendSuss=!1)}finally{a.sendLoading=!1}a.sendSuss=!0}},async handleSendRide(e){console.log("发送乘车记录=>",e);const t={role:y.Sc.user,customId:te(),id:te(),contentType:y.vx.ride,content:{ride_record:e},sendLoading:!0,sendSuss:!0,client_message_id:te()};this.chatList.push(t),this.goEnd(),this.handleRideRecordHide();const s={message:e.selfId,type:y.vx.ride,client_message_id:t.client_message_id};try{await this.createMessage(s)}catch(i){return void(t.sendSuss=!1)}finally{t.sendLoading=!1}t.sendSuss=!0},async handleChatClose(e=!1,t){if(console.log("挂断聊天",this.waitInfo.session_id,t),!this.waitInfo.session_id)return;if(this.waitInfo.session_id!=t)return;const s={session_id:t};console.log("挂断聊天",s);try{await O(s)}catch(i){return void(i.status==y.L_?(this.chatList.push({role:y.Sc.defaultTip,customId:te(),content:"- 网络异常 请稍后重试 -"}),this.goEnd(null,100)):i.status!=y.Eh&&this.$toast({message:i.msg}))}clearInterval(this.messageQuitTimer),this.messageQuitTimer=null,!0!==e&&this.chatList.push({role:y.Sc.defaultTip,customId:te(),content:"- 本次服务已完成，请为本次服务做出评价! -"}),this.chatList.push({role:y.Sc.evaluate,customId:te(),content:0,session_id:this.waitInfo.session_id}),this.initMessageInfo(),this.waitList.push(this.waitInfo),this.waitInfo={},this.goEnd(null,100)},async handleChangeRate(e,t){console.log("评分=>",e,t);const s={session_id:t.session_id,star_count:e};try{await Y(s)}catch(i){return i.status==y.L_?(this.chatList.push({role:y.Sc.defaultTip,customId:te(),content:"- 网络异常 请稍后重试 -"}),this.goEnd(null,100)):i.status!=y.Eh&&this.$toast({message:i.msg}),void(t.content=0)}this.chatList.push({role:y.Sc.defaultTip,customId:te(),content:"- 感谢您的评价，我们会继续努力 -"}),this.goEnd(null,100)},async handldeSubmitLeave(){if(!this.leaveInfo.contact_info)return void this.$toast({message:"请输入联系方式"});if(!K(this.leaveInfo.contact_info))return void this.$toast({message:"手机号码格式不正确"});if(!this.leaveInfo.issue_desc)return void this.$toast({message:"请输入问题"});const e={session_id:this.chatInfo.session_id,contact_info:this.leaveInfo.contact_info,issue_desc:this.leaveInfo.issue_desc};try{await N(e)}catch(t){return void(t.status!=y.Eh&&this.$toast({message:t.msg}))}this.leaveMessageVisible=!1,this.leaveMessageSuccVisible=!0,await ee(300),this.leaveInfo.contact_info="",this.leaveInfo.issue_desc=""},async onLoad(){},async handleLoadHistoryList(){const e=G(this.chatList).find((e=>e.selfId));if(!e)return this.chatFinished=!0,this.chatRefreshing=!1,void this.chatList.unshift({role:y.Sc.marginTip,customId:te(),content:"暂无更多历史记录~"});let t=await this.getMessage({mode:y.XI.prev,start_message_id:e.message_id});if(t=this.filterMessage(t),this.chatList.length>10)return this.chatFinished=!0,this.chatRefreshing=!1,void this.chatList.unshift({role:y.Sc.marginTip,customId:te(),content:"暂无更多历史记录~"});const s=document.getElementsByClassName("van-loading van-loading--circular")[0].offsetHeight,i=document.getElementsByClassName("chat-container")[0];this.chatRefreshing=!1,this.chatList.unshift(...t),this.initMoreBtn(),this.addChatTime(this.chatList,!0),this.$nextTick((()=>{i.scrollTo(0,document.getElementById(`${this.firstMsgId}`).offsetTop-s),console.log("=============",i.scrollTop,document.getElementById(`${this.firstMsgId}`).offsetTop,s),this.setFirstMsgId()}))},addChatTime(e,t){let s;if(e.length)if(t){let t=JSON.parse(JSON.stringify(e)).findIndex((e=>e.tips));for(let i=t;i>=0;i--){const n=e[i];if(i===t)s=n.createUnix;else if(n.createUnix&&n.createUnix+300<=s){let t;console.log("超过5分钟=>",W(n.createUnix),e),t=W(n.createUnix,"YYYY-MM-DD")==W(s,"YYYY-MM-DD")?W(n.createUnix,"HH:mm"):W(n.createUnix,"YYYY-MM-DD HH:mm"),e.splice(i,0,{createUnix:n.createUnix,tips:W(n.createUnix),role:y.Sc.defaultTip,content:t}),s=n.createUnix}}}else{let t=JSON.parse(JSON.stringify(e)).reverse().findIndex((e=>e.tips));t=t<0?0:e.length-1-t;for(let i=t;i<e.length;i++){const n=e[i];if(i===t)0===t&&e.splice(i,0,{createUnix:n.createUnix,tips:W(n.createUnix),role:y.Sc.defaultTip,customId:te(),content:W(n.createUnix,"YYYY-MM-DD HH:mm")}),s=n.createUnix;else if(n.createUnix>=s+300){let t;console.log("超过5分钟=>",n.createUnix,s+300,W(n.createUnix),W(s+300)),t=W(n.createUnix,"YYYY-MM-DD")==W(s,"YYYY-MM-DD")?W(n.createUnix,"HH:mm"):W(n.createUnix,"YYYY-MM-DD HH:mm"),e.splice(i,0,{createUnix:n.createUnix,tips:W(n.createUnix),role:y.Sc.defaultTip,customId:te(),content:t}),s=n.createUnix}}}},async handleRideSlideChange(){const e=this.rideTabList.tabList[this.rideTabList.tabIndex];console.log("结果=>",e)},async rideOnRefresh(e){console.log("rideOnRefresh=>",e);const t=this.rideTabList.tabList.find((t=>t.value==e.value));t.page=1;try{await this.initRideList({page:t.page,size:t.size,pay_method:t.value,refresh:!0})}catch(s){return s.status!=y.Eh&&this.$toast({message:s.msg}),t.refreshing=!1,void(t.finished=!1)}t.refreshing=!1,t.finished=!1},async handleMessageScorll(){},async handleSwitchKf(){if(this.waitInfo.state==y.yP.inqueue||this.waitInfo.state==y.yP.success)return;this.chatList.push({role:y.Sc.roundTip,customId:te(),content:"正在为您转接人工客服，请稍后…"}),this.goEnd(null,100);let e=!1;try{const t=await this.msqueueJoin();if(console.log("==========getQueueStatus",t),t.state==y.yP.success||0==t.in_queue_count)this.chatList.push({role:y.Sc.hangUpCard,content:"",customId:te(),kfId:t.staff_info.user_id,kfname:t.staff_info.nickname,session_id:t.session_id}),this.chatList.push({role:y.Sc.staff,contentType:y.vx.text,content:{text:`您好，客服${t.staff_info.nickname}为您服务，请问您有什么需要咨询的问题吗？`},customId:te(),sendSuss:!0,sendLoading:!1,showMoreBtn:!1,moreId:te(),kfId:t.staff_info.user_id,kfname:t.staff_info.nickname,kfAvatar:t.staff_info.avatar_url}),e=!0,this.chatInfo.session_id=t.session_id,this.watchChatActive();else if(t.state==y.yP.inqueue){if(this.waitInfo.in_queue_count===t.in_queue_count)return;this.chatList.push({role:y.Sc.roundTip,customId:te(),content:`在当前排队${t.in_queue_count}人，请稍后…`})}else t.state==y.yP.fail&&(this.chatList.push({role:y.Sc.leaveMsgBtn,customId:te(),content:"很抱歉，暂时无法为您提供服务，请留言我们会尽快与您取得联系！"}),e=!0);this.goEnd(null,100),this.waitInfo=t}catch(t){return void(t.message==y.L_?(this.chatList.push({role:y.Sc.defaultTip,customId:te(),content:"- 网络异常 请稍后重试 -"}),this.goEnd(null,100)):t.message!=y.Eh&&this.$toast({message:t.message}))}e||this.waitSwtichStaff()},async handleSendText(e,t){let s;if(t)s=t;else if(s=document.querySelector(".chat-footer-input").innerHTML,!s)return;console.log("结果content=>",s);const i={role:y.Sc.user,contentType:y.vx.text,content:{text:s},sendLoading:!0,sendSuss:!0,customId:te(),client_message_id:te()};this.chatList.push(i),t||(document.querySelector(".chat-footer-input").innerHTML="",this.chatInputContent=""),this.goEnd(null,100);const n={message:s,type:y.vx.text,client_message_id:i.client_message_id};let a;try{a=await this.createMessage(n)}catch(r){return void(i.sendSuss=!1)}finally{i.sendLoading=!1}i.sendSuss=!0;let o=await this.getMessage({mode:""});o=o.map((e=>(e.client_message_id=i.client_message_id,e.create_unix=parseInt((new Date).getTime()/1e3),e))),o=this.filterMessage(o),console.log("=======getMessageRegularTime",o);const c=[];o.forEach((e=>{let t=this.chatList.find((t=>t.client_message_id==e.client_message_id));t&&(console.log("==========",t,e),t=Object.assign(t,e)),c.push(e)})),this.chatList.push(c),this.addChatTime(this.chatList),this.initMoreBtn(),this.goEnd(),a.is_hit_msk&&(this.chatList.push({role:y.Sc.switchKfBtn,customId:te(),content:""}),this.goEnd(null,100))},async msqueueJoin(){console.log("msqueueJoin invoke");const e={session_id:this.chatInfo.session_id};let t;try{t=await D(e)}catch(s){throw s.status!=y.Eh&&s.status!=y.L_?new Error(s.msg):new Error(s.status)}return this.chatInfo.session_id=t.session_id,t},async messageQuit(){console.log("messageQuit invoke");const e={session_id:this.chatInfo.session_id};try{await R(e)}catch(t){return}},async sessionHeartbeat(){const e={session_id:this.chatInfo.session_id};try{await P(e)}catch(t){return}},async createMessage(e){const t={session_id:this.chatInfo.session_id,message:e.message,type:e.type,client_message_id:e.client_message_id};let s;try{s=await B(t)}catch(i){throw new Error(i.msg)}return this.waitInfo.session_id&&this.watchChatActive(),s},async getMessage(e){console.log("getMessage invoke",e);const t={session_id:this.chatInfo.session_id,mode:e.mode,start_message_id:e.start_message_id,size:e.size||y.NR};let s;console.log("getMessage req=",t);try{s=await U(t)}catch(i){return[]}return console.log("getMessage success resp=",s),s.message_list=s.message_list.map((e=>({...e,selfId:e.message_id}))),s.message_list},handleIssuesMoreShow(e){e.showMoreBtn=!1;const t=document.getElementById(e.moreId);t.classList.add("act")},handlePicShow(e){this.picSrc=e,this.picVisible=!0},handlePicHide(){this.picVisible=!1,this.picSrc=""},handleLeaveMessageSuccShow(){this.leaveMessageSuccVisible=!0},handleLeaveMessageSuccHide(){this.leaveMessageSuccVisible=!1},async handleRideRecordShow(){this.rideRecordVisible=!0},handleRideRecordHide(){this.rideRecordVisible=!1},setFirstMsgId(){this.chatList=this.chatList.map((e=>(e.id=te(),e))),this.firstMsgId=this.chatList[0].id},goEnd(e,t=200){this.$nextTick((()=>{setTimeout((()=>{if(this.$refs.common_chat_main){try{document.getElementsByClassName("chat-messages-item")[document.getElementsByClassName("chat-messages-item").length-1].scrollIntoView({behavior:"auto",block:"end",inline:"nearest"})}catch(t){}e&&e()}}),t)}))},handleTouchPage(){},handleInput(e){this.chatInputContent=e.target.innerHTML},handleInputBlur(){let e=navigator.userAgent;e.indexOf("iPhone")>-1&&window.scrollTo(0,0),this.chatInputFocus=!1},handleInputFocus(){this.$nextTick((()=>{this.chatInputFocus=!0}))},handleLeaveMessageShow(){this.leaveMessageVisible=!0},async handleLeaveMessageHide(){this.leaveMessageVisible=!1,await ee(300),this.leaveInfo.contact_info="",this.leaveInfo.issue_desc=""}}},Ae=_e,Ie=(0,r.Z)(Ae,fe,ge,!1,null,null,null),we=Ie.exports,ye=function(){var e=this;e._self._c;return e._m(0)},ke=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"error"},[t("div",{staticClass:"error-box"},[t("img",{attrs:{src:s(8288),alt:""}}),t("p",[e._v("页面地址不存在 请联系官方客服")])])])}],be={name:"ErrorPage"},Ce=be,Ee=(0,r.Z)(Ce,ye,ke,!1,null,"21e140d0",null),xe=Ee.exports;const Te=d.ZP.prototype.push;d.ZP.prototype.push=function(e,t,s){return t||s?Te.call(this,e,t,s):Te.call(this,e).catch((e=>e))},i.ZP.use(d.ZP);const Le=[{path:"/",name:"home",meta:{keepAlive:!0},component:we},{path:"/login",name:"Login",meta:{keepAlive:!0},component:me},{path:"/error",name:"Error",meta:{keepAlive:!1},component:xe},{path:"/leavemsg-list",name:"LeaveMsgList",meta:{keepAlive:!1},component:()=>s.e(100).then(s.bind(s,1118))},{path:"/leavemsg-detail",name:"LeaveMsgDetail",meta:{keepAlive:!1},component:()=>s.e(100).then(s.bind(s,9325))}],Se=new d.ZP({routes:Le});var Me=Se,Re=(s(5102),s(5110),s(7944),s(5650)),Pe=(s(4346),s(888)),Be=(s(7580),s(7937)),Ue=(s(6791),s(4269)),Ne=(s(3429),s(7722)),He=(s(4889),s(5705)),Oe=(s(5825),s(9858)),Ye=(s(109),s(6142)),De=(s(8778),s(5910)),Qe=(s(9571),s(4958)),Ze=(s(3772),s(2778)),Ve=(s(2443),s(9864)),Fe=(s(2699),s(8799)),ze=(s(4439),s(3462)),je=(s(5657),s(9538)),Ke=(s(4735),s(6471)),qe=(s(3089),s(4398)),Ge=(s(8146),s(8848)),We=(s(5816),s(9387)),Je=(s(2679),s(9054)),Xe=(s(836),s(6811)),$e=(s(446),s(7847)),et=(s(2763),s(5094)),tt=(s(6735),s(4319)),st=(s(3412),s(7740));i.ZP.use(st.Z),i.ZP.use(tt.Z),i.ZP.use(et.Z),i.ZP.use($e.Z),i.ZP.use(Xe.Z),i.ZP.use(Je.Z),i.ZP.use(We.Z),i.ZP.use(Ge.Z),i.ZP.use(qe.Z),i.ZP.use(Ke.Z),i.ZP.use(je.Z),i.ZP.use(ze.Z),i.ZP.use(Fe.Z),i.ZP.use(Ve.Z),i.ZP.use(Ze.Z),i.ZP.use(Qe.Z),i.ZP.use(De.Z),i.ZP.use(Ye.Z),i.ZP.use(Oe.Z),i.ZP.use(He.Z),i.ZP.use(Ne.Z),i.ZP.use(Ue.Z),i.ZP.use(Be.Z),i.ZP.use(Pe.Z),i.ZP.use(Re.Z);var it=s(7634),nt=s.n(it);const at=nt().Random;nt().setup({timeout:200}),nt().mock("/kfh5/user/login","post",{code:0,msg:"success",data:{token:"token",token_expire_unix:1697384212,token_refresh_unix:1697298412}}),nt().mock("/kfh5/user/token/refresh","post",{code:0,msg:"success",data:{token:"token",token_expire_unix:1697384212,token_refresh_unix:1697298412}}),nt().mock("/kfh5/user/profile","post",{code:0,msg:"success",data:{user_id:at.natural(),nickname:"assets",avatar_url:at.image("80x80")}}),nt().mock("/kfh5/message/session/init","post",{code:0,msg:"success",data:{session_id:at.natural(),state:"ROBOT",in_queue_count:1,staff_info:{user_id:at.natural(),nickname:"客服昵称"+at.natural(),avatar_url:at.image("80x80")},chat_window:{name:"聊天窗名称",notes:"备注",welcome_message:"欢迎语",prompt:"请输入您想咨询的问题…",robot:{nickname:"机器人名称",avatar_url:at.image("80x80")}}}}),nt().mock("/kfh5/message/session/quit","post",{code:0,msg:"success",data:{}}),nt().mock("/kfh5/message/session/heartbeat","post",{code:0,msg:"success",data:{}}),nt().mock("/kfh5/message/send","post",{code:0,msg:"success",data:{message_id:at.natural(),create_unix:1697384212,is_hit_msk:!0}}),nt().mock("/kfh5/message/pull","post",{code:0,msg:"success",data:{message_list:[{message_id:at.natural(),content:{text:"111",image:at.image("80x80"),ride_record:{id:"1",start_station:"起点站",terminal:"终点站",pay_unix:1688609733,amount:1}},staff_info:{"user_id|1":[0,1],nickname:"客服昵称"+at.natural(),avatar_url:at.image("80x80")},"belong_to|1":["USER"],"message_type|1":["TEXT"],"state|1":["NORMAL","RECALL"],create_unix:1698939641,client_message_id:1}]}}),nt().mock("/kfh5/message/leave","post",{code:0,msg:"success",data:{}}),nt().mock("/kfh5/message/msqueue/query","post",{code:0,msg:"success",data:{"session_id|1-100000":1,"in_queue_count|1-100000":1,"state|1":["SUCCESS"],staff_info:{user_id:at.natural(),nickname:"客服昵称",avatar_url:s(2227)}}}),nt().mock("/kfh5/message/msqueue/hand-up","post",{code:0,msg:"success",data:{}}),nt().mock("/kfh5/message/msqueue/evaluate","post",{code:0,msg:"success",data:{}}),nt().mock("/kfh5/message/msqueue/join","post",{code:0,msg:"success",data:{session_id:at.natural(),in_queue_count:1,"state|1":["INQUEUE"],staff_info:{user_id:at.natural(),nickname:"客服昵称",avatar_url:s(2227)}}}),nt().mock("/kfh5/message/banner/one","post",{code:0,msg:"success",data:{image_url:"https://img01.yzcdn.cn/vant/apple-1.jpg"}}),nt().mock("/kfh5/message/issue/hot/list","post",{code:0,msg:"success",data:{icon_url:s(9888),"issue_list|6":[{"id|1-1000000":1,content:"热门问题热门问题热门问题"+at.natural()}]}}),nt().mock("/kfh5/message/issue/relate/list","post",{code:0,msg:"success",data:{"issue_list|10":[{id:at.natural(),content:"关联问题关联问题关联问题"}]}}),nt().mock("/kfh5/message/order/riding/list","post",{code:0,msg:"success",data:{"riding_list|10":[{id:at.natural(),start_station:"起始站",terminal:"终点站","amount|0-100":23,pay_method:"支付方式",pay_unix:1688609733}]}}),nt().mock("/kfh5/message/filemanager/upload/apply","post",{code:0,msg:"success",data:{file_id:at.natural(),upload_url:"",hit:!0}}),nt().mock("/kfh5/message/filemanager/upload/success","post",{code:0,msg:"success",data:{file_id:at.natural(),"filename|IMAGE":["ATTACHMENT","IMAGE"],file_type:"string",filename:"文件名",md5:"string",content_type:"string","size|0-100":23,download_url:"string"}}),i.ZP.config.productionTip=!1,new i.ZP({router:Me,render:e=>e(u)}).$mount("#app")},9624:function(e,t,s){"use strict";s.d(t,{Eh:function(){return a},JK:function(){return h},LA:function(){return c},L_:function(){return o},NR:function(){return n},Ry:function(){return g},Sc:function(){return p},Sy:function(){return I},XI:function(){return f},bj:function(){return _},eC:function(){return d},gj:function(){return m},i2:function(){return l},iu:function(){return u},s$:function(){return y},vx:function(){return v},yP:function(){return A},z6:function(){return r}});const i=function(e,t){const s={};return e.forEach((e=>{const i=e[t];s[i]=e})),s},n=50,a=3,o=6,c="kf_a_tk",r="kt_r_tk",l="在线客服",u="请输入您想咨询的问题",d={zfb:"ZFB",wx:"WX",union:"UNION",digital:"DIGITAL",wxQrocode:"WXQRCODE"},h=[{value:d.zfb,label:"支付宝"},{value:d.wx,label:"微信"},{value:d.union,label:"银联"},{value:d.digital,label:"数币"},{value:d.wxQrocode,label:"微信乘车码"}],m=i(h,"value"),f={next:1,prev:2},g={attachment:"ATTACHMENT",image:"IMAGE"},p={hotIssues:"hotIssues",roundTip:"roundTip",defaultTip:"defaultTip",marginTip:"marginTip",switchKfBtn:"switchKfBtn",hangUpCard:"hangUpCard",evaluate:"evaluate",leaveMsg:"leaveMsg",leaveMsgBtn:"leaveMsgBtn",relatedIssues:"relatedIssues",user:"user",staff:"staff",robot:"robot"},v={text:"TEXT",image:"IMAGE",ride:"RIDE_RECORD",auto:"auto"},_={staff:"STAFF",user:"USER"},A={init:"ROBOT",inqueue:"INQUEUE",success:"SUCCESS",transfer:"TRANSFER",fail:"FAIL",evaluate:"EVALUATE"},I={dealed:"1",completion:"2"},w=[{value:I.dealed,label:"处理中",color:"#1890ff",tips:"您反馈的问题正在处理中，我们将尽快为您解决，如有疑问可联系在线客服"},{value:I.completion,label:"已办结",color:"#ff9400",tips:"您反馈的问题已办结，感谢您的反馈！"}],y=i(w,"value")},5102:function(){(function(e,t){var s=t.documentElement,i=e.devicePixelRatio||1;function n(){t.body?t.body.style.fontSize=12*i+"px":t.addEventListener("DOMContentLoaded",n)}function a(){var e=s.clientWidth/10;s.style.fontSize=e+"px"}if(n(),a(),e.addEventListener("resize",a),e.addEventListener("pageshow",(function(e){e.persisted&&a()})),i>=2){var o=t.createElement("body"),c=t.createElement("div");c.style.border=".5px solid transparent",o.appendChild(c),s.appendChild(o),1===c.offsetHeight&&s.classList.add("hairlines"),s.removeChild(o)}})(window,document)},8288:function(e,t,s){"use strict";e.exports=s.p+"img/404.50f167db.png"},2227:function(e){"use strict";e.exports="data:image/png;base64,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"},7945:function(e){"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAYAAACpSkzOAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAGqADAAQAAAABAAAAGgAAAABMybYKAAADIElEQVRIDb1WW0tiURRe2ilJKRkxIsGoQC0QhIzeesjquWD+y/yH6Xn+xkDzXGMPPck0oGKFFUFWDtFlwJcSb/N9O/cZT55TZ64LNvu21rf22ntdtkdeoZ2dnThYNtDW0CbRImikKloFbRtta3V19Ri9I3mcdrLZbLrdbm/6fL7M2NiYhMNhGR4eFsyVSL1el4eHB7m9vZWbmxvBPOv1et9lMpmvTpiW9U6nY8CKD3t7e+2rqytM3RF5KUNZSBgWUEwsFoHxDU72EadfTiaTMjAw8Jz/xXmr1ZJSqUQrd2H526Wlpe9awKsHPAWVRKPR5VQq9ctKiMODUZYYxLKzTGhyPp93d08uuIhFTG2I6vnwvN9ms+kCwh0LsYhJbCpRj0bvmpmZ8fS+ycXFhTQaDcuBXpsMDg7y2hQbsYh5dHS0iYUVAxoTYMhEIjo8nuDK5bKMj4+7fis6wvX1tamIKMQ8OzvL4ArjBqxZZ5zYUSwWE8MwhNYFg0EJhUJ2bGrt8fFRKXrOQOzLy8sNet0ag9GJqIQgh4eHgkM5sTmud7HXqGiSEe9EtOTu7k4CgYAg8k02ZoWTkxNz7jToYk/SGSI6rdgx87rS6bRKP3ofHiVwX+G70AGmpqb0Vl/fxY78PGIfy9NCpVKR/f195jK1AOeWYrGoct/i4iLvX+U6B3G93KGiqgbRq7pnwjw/P5eJiQnTAnojXZeOMjQ0pDIBXFhqtZoWs/Rd7G+8ugruO+73+y0MnJyensr8/LyMjo6qmMrlckrJwsKCyTsyMiJzc3NycHBgrvUO+JagCi3a5sntaHZ2Vinhnh7b5UG68PT0tB2EKiPY2DbgSZ9QT94nEok+RtaZ+/t7c51ehwA0570DOoYdEQO0pcoEIvczzLdkhz9NQUSvVquC98ui+q6oXMfKiJN+Qcox853OWRT4HaKFwOwQ2yL/X8oENSI+WMKzcF93deAFLmIQi5jaGjNgPR5Pk+UXb7NbKBRU1Gsmtz2vi7LEIBYxHWW7lv3bz0mvdlZGZOu/9t2y/IJ6FekxCyMUrmPu+IFkLOI/V9Yydv0PUnwd+L26wAgAAAAASUVORK5CYII="},7726:function(e){"use strict";e.exports="data:image/png;base64,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"},8773:function(e,t,s){"use strict";e.exports=s.p+"img/5.464e9d54.png"},9888:function(e){"use strict";e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAEKADAAQAAAABAAAAEAAAAAA0VXHyAAACGUlEQVQ4EaVSvWvTURS99700TWMHBV2E6uAXLYI4VHBwECddTMCoUBIFIYNYR/0zBB1EoaLVqjRQSQcRBKU4ulUFqYqKBcFB7dCkCb53PDfxhba49Q6/+33uuff3RDYour4f1Wq+9WP5AkQLAtkBkUFVeSOKuVwmd1NrEz9X96wBaBQrhxXhESA7Vxclm0BLTv25/ieT9V4sGe1C5VBAfAHBphT7n+ZEiPfHBmYmX1re2Qfj4/1B4v3UrOrueC8lFZ3i1GA1SbiSSgz3UDi/2WIdgObi7yKAvalIgLOifkGdLPIWZQK1OPl9ynPFoaaEag9AI06mpGmovJMQ98SIqyQ8SqAbLtNXJJuHqU6Bo2Z3VxDZnRKmM+IuBeC62aq4THbPEP8MKdyUxUw4ZNR0B4DITXNMVPVTUBygud180vXich+pT8FhC0O/LK6ChukOAGl+NqcriNw3y70bKn7MYoitK2RRhfovdA2Eot/s22XgZdqcruguRMyT4t1cdnCWhfOkcZEj6y6E/amKx50xm8M4oTTtm+3Z17QOdoKqC+RdjhJOQ9xbvkJlQ5PHnuCvznPP7wN9+WGt3V7qAFhTqzQ2EtoyR3Or+SZcY5lMnrN7mI37/sVWxLsT6SH1ACzZKpaHI3CL+x4xf73w2F95/vJA/cGrlFsDkIIrhcpxSDzDVzfCWJZH/sC38DSX2fZYa9d6fyzVb0j/BWjry5Lzz59vAAAAAElFTkSuQmCC"},5819:function(){}},t={};function s(i){var n=t[i];if(void 0!==n)return n.exports;var a=t[i]={exports:{}};return e[i].call(a.exports,a,a.exports,s),a.exports}s.m=e,function(){var e=[];s.O=function(t,i,n,a){if(!i){var o=1/0;for(u=0;u<e.length;u++){i=e[u][0],n=e[u][1],a=e[u][2];for(var c=!0,r=0;r<i.length;r++)(!1&a||o>=a)&&Object.keys(s.O).every((function(e){return s.O[e](i[r])}))?i.splice(r--,1):(c=!1,a<o&&(o=a));if(c){e.splice(u--,1);var l=n();void 0!==l&&(t=l)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[i,n,a]}}(),function(){s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,{a:t}),t}}(),function(){s.d=function(e,t){for(var i in t)s.o(t,i)&&!s.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){s.f={},s.e=function(e){return Promise.all(Object.keys(s.f).reduce((function(t,i){return s.f[i](e,t),t}),[]))}}(),function(){s.u=function(e){return"js/group-foo.8a408e51.js"}}(),function(){s.miniCssF=function(e){return"css/group-foo.4a3a874f.css"}}(),function(){s.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="h5:";s.l=function(i,n,a,o){if(e[i])e[i].push(n);else{var c,r;if(void 0!==a)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==i||d.getAttribute("data-webpack")==t+a){c=d;break}}c||(r=!0,c=document.createElement("script"),c.charset="utf-8",c.timeout=120,s.nc&&c.setAttribute("nonce",s.nc),c.setAttribute("data-webpack",t+a),c.src=i),e[i]=[n];var h=function(t,s){c.onerror=c.onload=null,clearTimeout(m);var n=e[i];if(delete e[i],c.parentNode&&c.parentNode.removeChild(c),n&&n.forEach((function(e){return e(s)})),t)return t(s)},m=setTimeout(h.bind(null,void 0,{type:"timeout",target:c}),12e4);c.onerror=h.bind(null,c.onerror),c.onload=h.bind(null,c.onload),r&&document.head.appendChild(c)}}}(),function(){s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){s.p="./"}(),function(){if("undefined"!==typeof document){var e=function(e,t,s,i,n){var a=document.createElement("link");a.rel="stylesheet",a.type="text/css";var o=function(s){if(a.onerror=a.onload=null,"load"===s.type)i();else{var o=s&&("load"===s.type?"missing":s.type),c=s&&s.target&&s.target.href||t,r=new Error("Loading CSS chunk "+e+" failed.\n("+c+")");r.code="CSS_CHUNK_LOAD_FAILED",r.type=o,r.request=c,a.parentNode&&a.parentNode.removeChild(a),n(r)}};return a.onerror=a.onload=o,a.href=t,s?s.parentNode.insertBefore(a,s.nextSibling):document.head.appendChild(a),a},t=function(e,t){for(var s=document.getElementsByTagName("link"),i=0;i<s.length;i++){var n=s[i],a=n.getAttribute("data-href")||n.getAttribute("href");if("stylesheet"===n.rel&&(a===e||a===t))return n}var o=document.getElementsByTagName("style");for(i=0;i<o.length;i++){n=o[i],a=n.getAttribute("data-href");if(a===e||a===t)return n}},i=function(i){return new Promise((function(n,a){var o=s.miniCssF(i),c=s.p+o;if(t(o,c))return n();e(i,c,null,n,a)}))},n={143:0};s.f.miniCss=function(e,t){var s={100:1};n[e]?t.push(n[e]):0!==n[e]&&s[e]&&t.push(n[e]=i(e).then((function(){n[e]=0}),(function(t){throw delete n[e],t})))}}}(),function(){var e={143:0};s.f.j=function(t,i){var n=s.o(e,t)?e[t]:void 0;if(0!==n)if(n)i.push(n[2]);else{var a=new Promise((function(s,i){n=e[t]=[s,i]}));i.push(n[2]=a);var o=s.p+s.u(t),c=new Error,r=function(i){if(s.o(e,t)&&(n=e[t],0!==n&&(e[t]=void 0),n)){var a=i&&("load"===i.type?"missing":i.type),o=i&&i.target&&i.target.src;c.message="Loading chunk "+t+" failed.\n("+a+": "+o+")",c.name="ChunkLoadError",c.type=a,c.request=o,n[1](c)}};s.l(o,r,"chunk-"+t,t)}},s.O.j=function(t){return 0===e[t]};var t=function(t,i){var n,a,o=i[0],c=i[1],r=i[2],l=0;if(o.some((function(t){return 0!==e[t]}))){for(n in c)s.o(c,n)&&(s.m[n]=c[n]);if(r)var u=r(s)}for(t&&t(i);l<o.length;l++)a=o[l],s.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return s.O(u)},i=self["webpackChunkh5"]=self["webpackChunkh5"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=s.O(void 0,[998],(function(){return s(9335)}));i=s.O(i)})();
//# sourceMappingURL=app.26f3633d.js.map